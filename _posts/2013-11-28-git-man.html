---
layout: default
title: git服务器的搭建
---

<h1>git服务器的搭建</h1>

<p>使用git进行源代码管理的好处，就不多说了，简直就是一根魔法棒吧，有时它也可以被当成后悔药吃.</p>

<p>下面是记录我的一些使用经验，内容一如既往的零散，仅能作为日常使用的参考，详细的当然还是看man page了.</p>

<h2>git服务器的搭建</h2>

<p>ubuntu系统直接apt安装三个包：</p>

<pre><code>sudo apt-get install git
sudo apt-get install gitolite
sudo apt-get install git-core
</code></pre>

<p>然后在服务器端创建git专用帐号，以后所有用户都通过这个帐号访问git：</p>

<pre><code>sudo useradd --system --shell /bin/bash --user-group git
</code></pre>

<p>给新帐号设置口令：</p>

<pre><code>sudo passwd git
</code></pre>

<p>但如果是gentoo系统，通过portage安装gitolite，是会自动生成git帐号的.</p>

<p>然后管理员在自己的机器上生成自己的ssh密钥，并远程拷贝到服务器上：</p>

<pre><code>ssh-keygen -t rsa
scp .ssh/xx_rsa.pub git@server:/tmp/
</code></pre>

<p>在服务器端执行：</p>

<pre><code>gl-setup /tmp/xx_rsa.pub
</code></pre>

<p>这会在home目录下生成projects.list和repositories，repositories下有两个项目gitolite-admin.git和testing.git，其中gitolite-admin是管理服务器上所有仓库的仓库；testing.git顾名思义就是一个用于测试的仓库.</p>

<p>接着在管理员的客户端克隆gitolite-admin：</p>

<pre><code>git clone git@server:gitolite-admin
</code></pre>

<p>如果出现以下错误：</p>

<pre><code>Cloning into 'gitolite-admin'...
fatal: 'gitolite-admin.git' does not appear to be a git repository
fatal: The remote end hung up unexpectedly
It might be because a public key has been added to the authorized_keys file
for the gitolite git user account.
you can only have keys generated by Gitolite in the authorized_key file.
</code></pre>

<p>这时就需要把管理员本机上以前生成果的key文件删除就好，只保留上面生成的xx_rsa.pub. 这样会把服务器上的gitolite-admin仓库拉取到本地，在这个仓库中进行新仓库的创建，删除，权限的更改等操作.并且这些修改都可以直接在本地完成后提交到服务器即可，不需要登录到服务器上操作，git分布式管理的理念贯彻得很完美.</p>

<p>Author:leung</p>
<p>{{ page.date | date_to_string }}</p>

